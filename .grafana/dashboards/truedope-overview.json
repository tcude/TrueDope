{
  "dashboard": {
    "title": "TrueDope Overview",
    "description": "Application health, business metrics, and infrastructure monitoring for TrueDope",
    "tags": ["truedope", "application", "monitoring"],
    "timezone": "browser",
    "schemaVersion": 39,
    "refresh": "30s",
    "time": {
      "from": "now-6h",
      "to": "now"
    },
    "templating": {
      "list": [
        {
          "name": "rate_interval",
          "type": "custom",
          "label": "Rate Interval",
          "current": {
            "text": "5m",
            "value": "5m"
          },
          "options": [
            { "text": "1m", "value": "1m", "selected": false },
            { "text": "5m", "value": "5m", "selected": true },
            { "text": "15m", "value": "15m", "selected": false },
            { "text": "30m", "value": "30m", "selected": false },
            { "text": "1h", "value": "1h", "selected": false }
          ],
          "query": "1m,5m,15m,30m,1h"
        }
      ]
    },
    "panels": [
      {
        "type": "row",
        "title": "Application Health",
        "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
        "collapsed": false
      },
      {
        "type": "stat",
        "title": "Request Rate",
        "description": "HTTP requests per minute",
        "gridPos": { "h": 4, "w": 6, "x": 0, "y": 1 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum(rate(http_requests_received_total{job=\"truedope-backend\"}[$rate_interval])) * 60",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "decimals": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "blue", "value": null }
              ]
            },
            "color": { "mode": "thresholds" }
          }
        },
        "options": {
          "colorMode": "background_solid",
          "graphMode": "area",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          },
          "textMode": "auto",
          "postfix": " req/min"
        }
      },
      {
        "type": "stat",
        "title": "Error Rate",
        "description": "Percentage of 5xx responses",
        "gridPos": { "h": 4, "w": 6, "x": 6, "y": 1 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "(sum(rate(http_requests_received_total{job=\"truedope-backend\",code=~\"5..\"}[$rate_interval])) or vector(0)) / (sum(rate(http_requests_received_total{job=\"truedope-backend\"}[$rate_interval])) > 0) * 100 or vector(0)",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "decimals": 2,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 1 },
                { "color": "red", "value": 5 }
              ]
            },
            "color": { "mode": "thresholds" },
            "mappings": [
              { "type": "special", "options": { "match": "nan", "result": { "text": "0%", "color": "green" } } }
            ]
          }
        },
        "options": {
          "colorMode": "background_solid",
          "graphMode": "area",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "stat",
        "title": "P95 Latency",
        "description": "95th percentile response time",
        "gridPos": { "h": 4, "w": 6, "x": 12, "y": 1 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{job=\"truedope-backend\"}[$rate_interval])) by (le)) * 1000",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "ms",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 200 },
                { "color": "red", "value": 500 }
              ]
            },
            "color": { "mode": "thresholds" }
          }
        },
        "options": {
          "colorMode": "background_solid",
          "graphMode": "area",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "stat",
        "title": "In-Flight Requests",
        "description": "Currently processing requests",
        "gridPos": { "h": 4, "w": 6, "x": 18, "y": 1 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum(http_requests_in_progress{job=\"truedope-backend\"})",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 50 },
                { "color": "red", "value": 100 }
              ]
            },
            "color": { "mode": "thresholds" }
          }
        },
        "options": {
          "colorMode": "background_solid",
          "graphMode": "area",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "row",
        "title": "Business Metrics (24h)",
        "gridPos": { "h": 1, "w": 24, "x": 0, "y": 5 },
        "collapsed": false
      },
      {
        "type": "stat",
        "title": "Sessions Today",
        "description": "Shooting sessions created in last 24 hours",
        "gridPos": { "h": 4, "w": 6, "x": 0, "y": 6 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum(increase(truedope_sessions_created_total[24h]))",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "blue", "value": null }
              ]
            },
            "color": { "mode": "thresholds" }
          }
        },
        "options": {
          "colorMode": "value",
          "graphMode": "none",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "stat",
        "title": "DOPE Entries",
        "description": "DOPE entries logged in last 24 hours",
        "gridPos": { "h": 4, "w": 6, "x": 6, "y": 6 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum(increase(truedope_dope_entries_created_total[24h]))",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "purple", "value": null }
              ]
            },
            "color": { "mode": "thresholds" }
          }
        },
        "options": {
          "colorMode": "value",
          "graphMode": "none",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "stat",
        "title": "Logins Today",
        "description": "Successful authentications in last 24 hours",
        "gridPos": { "h": 4, "w": 6, "x": 12, "y": 6 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum(increase(truedope_logins_successful_total[24h]))",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "green", "value": null }
              ]
            },
            "color": { "mode": "thresholds" }
          }
        },
        "options": {
          "colorMode": "value",
          "graphMode": "none",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "stat",
        "title": "Failed Logins",
        "description": "Failed login attempts (watch for brute force)",
        "gridPos": { "h": 4, "w": 6, "x": 18, "y": 6 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum(increase(truedope_logins_failed_total[24h]))",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 10 },
                { "color": "orange", "value": 50 },
                { "color": "red", "value": 100 }
              ]
            },
            "color": { "mode": "thresholds" }
          }
        },
        "options": {
          "colorMode": "background_solid",
          "graphMode": "none",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "row",
        "title": "Traffic Analysis",
        "gridPos": { "h": 1, "w": 24, "x": 0, "y": 10 },
        "collapsed": false
      },
      {
        "type": "timeseries",
        "title": "Requests by Status Code",
        "description": "Requests per minute grouped by HTTP status code",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 11 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum by (code) (rate(http_requests_received_total{job=\"truedope-backend\"}[$rate_interval])) * 60",
            "legendFormat": "{{code}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "fillOpacity": 20,
              "showPoints": "never",
              "axisLabel": "req/min"
            }
          },
          "overrides": [
            { "matcher": { "id": "byName", "options": "200" }, "properties": [{ "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "201" }, "properties": [{ "id": "color", "value": { "fixedColor": "light-green", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "204" }, "properties": [{ "id": "color", "value": { "fixedColor": "super-light-green", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "400" }, "properties": [{ "id": "color", "value": { "fixedColor": "yellow", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "401" }, "properties": [{ "id": "color", "value": { "fixedColor": "orange", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "404" }, "properties": [{ "id": "color", "value": { "fixedColor": "light-orange", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "500" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] }
          ]
        },
        "options": {
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "calcs": ["lastNotNull", "mean"]
          }
        }
      },
      {
        "type": "timeseries",
        "title": "Requests by Controller",
        "description": "Requests per minute by API controller",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 11 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "sum by (controller) (rate(http_requests_received_total{job=\"truedope-backend\"}[$rate_interval])) * 60",
            "legendFormat": "{{controller}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "fillOpacity": 20,
              "showPoints": "never",
              "axisLabel": "req/min"
            }
          }
        },
        "options": {
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "calcs": ["lastNotNull", "mean"]
          }
        }
      },
      {
        "type": "row",
        "title": "Response Time Analysis",
        "gridPos": { "h": 1, "w": 24, "x": 0, "y": 19 },
        "collapsed": false
      },
      {
        "type": "timeseries",
        "title": "Response Time Percentiles",
        "description": "p50, p95, and p99 latency over time",
        "gridPos": { "h": 8, "w": 16, "x": 0, "y": 20 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "histogram_quantile(0.50, sum(rate(http_request_duration_seconds_bucket{job=\"truedope-backend\"}[$rate_interval])) by (le))",
            "legendFormat": "p50 (median)",
            "refId": "A"
          },
          {
            "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{job=\"truedope-backend\"}[$rate_interval])) by (le))",
            "legendFormat": "p95",
            "refId": "B"
          },
          {
            "expr": "histogram_quantile(0.99, sum(rate(http_request_duration_seconds_bucket{job=\"truedope-backend\"}[$rate_interval])) by (le))",
            "legendFormat": "p99",
            "refId": "C"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "fillOpacity": 10,
              "showPoints": "never"
            }
          },
          "overrides": [
            { "matcher": { "id": "byName", "options": "p50 (median)" }, "properties": [{ "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "p95" }, "properties": [{ "id": "color", "value": { "fixedColor": "yellow", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "p99" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] }
          ]
        },
        "options": {
          "legend": {
            "displayMode": "table",
            "placement": "bottom",
            "calcs": ["lastNotNull", "mean", "max"]
          }
        }
      },
      {
        "type": "bargauge",
        "title": "Slowest Endpoints",
        "description": "Average response time by endpoint",
        "gridPos": { "h": 8, "w": 8, "x": 16, "y": 20 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "topk(10, avg by (controller, action) (rate(http_request_duration_seconds_sum{job=\"truedope-backend\"}[5m]) / rate(http_request_duration_seconds_count{job=\"truedope-backend\"}[5m])))",
            "legendFormat": "{{controller}}/{{action}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 0.2 },
                { "color": "red", "value": 0.5 }
              ]
            },
            "color": { "mode": "thresholds" },
            "min": 0
          }
        },
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "row",
        "title": "Business Activity",
        "gridPos": { "h": 1, "w": 24, "x": 0, "y": 28 },
        "collapsed": false
      },
      {
        "type": "timeseries",
        "title": "Data Creation Activity",
        "description": "Hourly data creation across entity types",
        "gridPos": { "h": 8, "w": 8, "x": 0, "y": 29 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "increase(truedope_sessions_created_total[1h])",
            "legendFormat": "Sessions",
            "refId": "A"
          },
          {
            "expr": "increase(truedope_dope_entries_created_total[1h])",
            "legendFormat": "DOPE Entries",
            "refId": "B"
          },
          {
            "expr": "increase(truedope_chrono_sessions_created_total[1h])",
            "legendFormat": "Chrono Sessions",
            "refId": "C"
          },
          {
            "expr": "increase(truedope_group_entries_created_total[1h])",
            "legendFormat": "Groups",
            "refId": "D"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "fillOpacity": 20,
              "showPoints": "never"
            }
          }
        },
        "options": {
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "calcs": ["lastNotNull", "sum"]
          }
        }
      },
      {
        "type": "timeseries",
        "title": "Authentication Activity",
        "description": "Hourly auth events",
        "gridPos": { "h": 8, "w": 8, "x": 8, "y": 29 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "increase(truedope_logins_successful_total[1h])",
            "legendFormat": "Successful Logins",
            "refId": "A"
          },
          {
            "expr": "increase(truedope_logins_failed_total[1h])",
            "legendFormat": "Failed Logins",
            "refId": "B"
          },
          {
            "expr": "increase(truedope_registrations_total[1h])",
            "legendFormat": "Registrations",
            "refId": "C"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "fillOpacity": 20,
              "showPoints": "never"
            }
          },
          "overrides": [
            { "matcher": { "id": "byName", "options": "Successful Logins" }, "properties": [{ "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "Failed Logins" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] },
            { "matcher": { "id": "byName", "options": "Registrations" }, "properties": [{ "id": "color", "value": { "fixedColor": "blue", "mode": "fixed" } }] }
          ]
        },
        "options": {
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "calcs": ["lastNotNull", "sum"]
          }
        }
      },
      {
        "type": "timeseries",
        "title": "Equipment Creation (24h rolling)",
        "description": "Equipment records created",
        "gridPos": { "h": 8, "w": 8, "x": 16, "y": 29 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "increase(truedope_rifles_created_total[24h])",
            "legendFormat": "Rifles",
            "refId": "A"
          },
          {
            "expr": "increase(truedope_ammunition_created_total[24h])",
            "legendFormat": "Ammunition",
            "refId": "B"
          },
          {
            "expr": "increase(truedope_locations_created_total[24h])",
            "legendFormat": "Locations",
            "refId": "C"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "fillOpacity": 20,
              "showPoints": "never"
            }
          }
        },
        "options": {
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "calcs": ["lastNotNull", "sum"]
          }
        }
      },
      {
        "type": "row",
        "title": "Infrastructure",
        "gridPos": { "h": 1, "w": 24, "x": 0, "y": 37 },
        "collapsed": false
      },
      {
        "type": "timeseries",
        "title": "PostgreSQL Active Connections",
        "description": "Database connection count",
        "gridPos": { "h": 6, "w": 6, "x": 0, "y": 38 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
            "editorMode": "code",
            "expr": "sum(pg_stat_activity_count{job=\"postgres\", datname=\"truedope\"})",
            "legendFormat": "Connections",
            "refId": "A",
            "instant": false,
            "range": true
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "color": { "mode": "palette-classic" },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "barAlignment": 0,
              "drawStyle": "line",
              "fillOpacity": 20,
              "gradientMode": "none",
              "hideFrom": { "legend": false, "tooltip": false, "viz": false },
              "insertNulls": false,
              "lineInterpolation": "smooth",
              "lineWidth": 1,
              "pointSize": 5,
              "scaleDistribution": { "type": "linear" },
              "showPoints": "never",
              "spanNulls": false,
              "stacking": { "group": "A", "mode": "none" },
              "thresholdsStyle": { "mode": "off" }
            },
            "min": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "green", "value": null },
                { "color": "yellow", "value": 80 },
                { "color": "red", "value": 95 }
              ]
            }
          },
          "overrides": []
        },
        "options": {
          "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
          "tooltip": { "mode": "single", "sort": "none" }
        }
      },
      {
        "type": "timeseries",
        "title": "Redis Memory Usage",
        "description": "Redis memory consumption",
        "gridPos": { "h": 6, "w": 6, "x": 6, "y": 38 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
            "editorMode": "code",
            "expr": "redis_memory_used_bytes{job=\"redis\"}",
            "legendFormat": "Used Memory",
            "refId": "A",
            "instant": false,
            "range": true
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "bytes",
            "color": { "mode": "palette-classic" },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "barAlignment": 0,
              "drawStyle": "line",
              "fillOpacity": 20,
              "gradientMode": "none",
              "hideFrom": { "legend": false, "tooltip": false, "viz": false },
              "insertNulls": false,
              "lineInterpolation": "smooth",
              "lineWidth": 1,
              "pointSize": 5,
              "scaleDistribution": { "type": "linear" },
              "showPoints": "never",
              "spanNulls": false,
              "stacking": { "group": "A", "mode": "none" },
              "thresholdsStyle": { "mode": "off" }
            },
            "min": 0
          },
          "overrides": []
        },
        "options": {
          "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
          "tooltip": { "mode": "single", "sort": "none" }
        }
      },
      {
        "type": "timeseries",
        "title": "Backend Memory Usage",
        "description": ".NET process working set",
        "gridPos": { "h": 6, "w": 6, "x": 12, "y": 38 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
            "editorMode": "code",
            "expr": "process_working_set_bytes{job=\"truedope-backend\"}",
            "legendFormat": "Working Set",
            "refId": "A",
            "instant": false,
            "range": true
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "bytes",
            "color": { "mode": "palette-classic" },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "barAlignment": 0,
              "drawStyle": "line",
              "fillOpacity": 20,
              "gradientMode": "none",
              "hideFrom": { "legend": false, "tooltip": false, "viz": false },
              "insertNulls": false,
              "lineInterpolation": "smooth",
              "lineWidth": 1,
              "pointSize": 5,
              "scaleDistribution": { "type": "linear" },
              "showPoints": "never",
              "spanNulls": false,
              "stacking": { "group": "A", "mode": "none" },
              "thresholdsStyle": { "mode": "off" }
            },
            "min": 0
          },
          "overrides": []
        },
        "options": {
          "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
          "tooltip": { "mode": "single", "sort": "none" }
        }
      },
      {
        "type": "timeseries",
        "title": "GC Collections/sec",
        "description": ".NET garbage collection rate by generation",
        "gridPos": { "h": 6, "w": 6, "x": 18, "y": 38 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "expr": "rate(dotnet_collection_count_total{job=\"truedope-backend\"}[$rate_interval])",
            "legendFormat": "Gen {{generation}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "cps",
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "fillOpacity": 20,
              "showPoints": "never"
            }
          }
        },
        "options": {
          "legend": {
            "displayMode": "list",
            "placement": "bottom"
          }
        }
      },
      {
        "type": "stat",
        "title": "Backend Uptime",
        "description": "Time since last backend restart",
        "gridPos": { "h": 6, "w": 6, "x": 0, "y": 44 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
            "editorMode": "code",
            "expr": "time() - process_start_time_seconds{job=\"truedope-backend\"}",
            "refId": "A",
            "instant": true
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "color": { "mode": "thresholds" },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "yellow", "value": null },
                { "color": "green", "value": 3600 }
              ]
            }
          }
        },
        "options": {
          "colorMode": "background_solid",
          "graphMode": "none",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      },
      {
        "type": "timeseries",
        "title": "Database Size",
        "description": "PostgreSQL truedope database size",
        "gridPos": { "h": 6, "w": 6, "x": 6, "y": 44 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
            "editorMode": "code",
            "expr": "pg_database_size_bytes{datname=\"truedope\"}",
            "legendFormat": "Database Size",
            "refId": "A",
            "instant": false,
            "range": true
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "bytes",
            "color": { "mode": "palette-classic" },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "drawStyle": "line",
              "fillOpacity": 20,
              "lineInterpolation": "smooth",
              "lineWidth": 1,
              "showPoints": "never",
              "spanNulls": false,
              "stacking": { "group": "A", "mode": "none" },
              "thresholdsStyle": { "mode": "off" }
            },
            "min": 0
          },
          "overrides": []
        },
        "options": {
          "legend": { "calcs": ["lastNotNull"], "displayMode": "list", "placement": "bottom", "showLegend": true },
          "tooltip": { "mode": "single", "sort": "none" }
        }
      },
      {
        "type": "timeseries",
        "title": "Image Storage Uploaded",
        "description": "Cumulative image data uploaded",
        "gridPos": { "h": 6, "w": 6, "x": 12, "y": 44 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
            "editorMode": "code",
            "expr": "truedope_image_bytes_uploaded_total",
            "legendFormat": "Total Uploaded",
            "refId": "A",
            "instant": false,
            "range": true
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "bytes",
            "color": { "mode": "palette-classic" },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "drawStyle": "line",
              "fillOpacity": 20,
              "lineInterpolation": "smooth",
              "lineWidth": 1,
              "showPoints": "never",
              "spanNulls": false,
              "stacking": { "group": "A", "mode": "none" },
              "thresholdsStyle": { "mode": "off" }
            },
            "min": 0
          },
          "overrides": []
        },
        "options": {
          "legend": { "calcs": ["lastNotNull"], "displayMode": "list", "placement": "bottom", "showLegend": true },
          "tooltip": { "mode": "single", "sort": "none" }
        }
      },
      {
        "type": "stat",
        "title": "Total Images",
        "description": "Total images uploaded all-time",
        "gridPos": { "h": 6, "w": 6, "x": 18, "y": 44 },
        "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
        "targets": [
          {
            "datasource": { "type": "prometheus", "uid": "${DS_TRUEDOPE_PROMETHEUS}" },
            "editorMode": "code",
            "expr": "sum(truedope_images_uploaded_total)",
            "refId": "A",
            "instant": true
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "none",
            "decimals": 0,
            "color": { "mode": "thresholds" },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "blue", "value": null }
              ]
            }
          }
        },
        "options": {
          "colorMode": "background_solid",
          "graphMode": "none",
          "reduceOptions": {
            "calcs": ["lastNotNull"],
            "fields": "",
            "values": false
          }
        }
      }
    ]
  },
  "__inputs": [
    {
      "name": "DS_TRUEDOPE_PROMETHEUS",
      "label": "TrueDope Prometheus",
      "description": "Prometheus data source for TrueDope metrics",
      "type": "datasource",
      "pluginId": "prometheus",
      "pluginName": "Prometheus"
    }
  ],
  "__requires": [
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "10.0.0"
    },
    {
      "type": "datasource",
      "id": "prometheus",
      "name": "Prometheus",
      "version": "1.0.0"
    }
  ]
}
