# Bugs and Features - December 30, 2025

Items organized from easiest to hardest to implement.

---

## 1. ✅ Summary Cards - Make Functional
**Difficulty:** Easy | **Type:** iOS Feature | **Status:** COMPLETED (2024-12-30)

Make the Summary cards on the home screen functional/tappable.

**Requirements:**
- Sessions card → navigates to Sessions tab ✅
- Rounds Fired card → navigates to Analytics tab ✅
- Longest Shot card → navigates to session with longest shot ✅
- Best Group card → navigates to session with best group ✅

**Implementation Notes:**
- Added `onTap` callbacks to `StatCard` and `AchievementCard` components
- Created `CardButtonStyle` for subtle press feedback (scale + opacity)
- Achievement cards only interactive when data exists
- Wired up navigation in `DashboardView`

---

## 2. Velocity Analytics - Multi-Rifle Filter
**Difficulty:** Easy-Medium | **Type:** iOS Bug Fix | **Effort:** ~2-4 hours

Velocity trends and analytics were designed assuming one rifle per ammo type. However, the same ammo (e.g., 77g OTM) produces very different velocities from different barrel lengths (14.5" vs 10.3").

**Decision:** Add a global rifle filter at the top of the Analytics tab.

**Implementation Approach:**
- Phase 1: Global rifle selector at top of Analytics tab (defaults to "All" or last-used)
- Phase 2 (future): Per-chart override capability if users request it

**Why Easy-Medium:** UI component (picker) + filtering existing data. Charts already exist, just need to filter the data source.

**Note:** This applies to other analytics tools that currently assume one rifle per caliber.

---

## 3. Group Measurement - Duplicate Thumbnails Bug
**Difficulty:** Medium | **Type:** iOS Bug Fix | **Effort:** ~2-4 hours

**Reproducibility:** All groups (confirmed)

Creating a group spawns two thumbnails afterward that are both just a pic of the target.

**Expected Behavior:**
- One thumbnail: original pic of the target
- Second thumbnail: overlay with bullet holes, POA, and measurement widget

**Why Medium:** Requires debugging image generation/saving flow. Need to trace where the overlay rendering happens (or doesn't) and ensure two distinct images are created and stored correctly.

---

## 4. Group Measurement Tool - Pinch to Zoom + Caliber-Scaled Markers
**Difficulty:** Medium | **Type:** iOS Feature | **Effort:** ~4-6 hours

The group measurement tool should allow the user to pinch to zoom when establishing bullet holes or POA.

Additionally, the current green circles for the bullet markers are a bit large. Like Ballistic X, let users select caliber FIRST (after setting 1" reference), then scale the green impact circles to match actual bullet diameter. This prevents overcrowding on tight groups.

**Why Medium:** Pinch-to-zoom requires gesture handling on the image view. Caliber-scaled markers need the reference scale + bullet diameter to calculate correct circle size. Both are UI work, no backend changes.

---

## 5. Group Measurement - Overlay Widget & Export
**Difficulty:** Medium-Hard | **Type:** iOS Feature | **Effort:** ~6-10 hours

The measurement tool should allow the user to place a widget on top of their group pic (similar to Ballistic X).

**Requirements:**
- Widget overlay showing measurements
- Image with overlay saved to the group
- User should be able to export this image

**Widget Stats (Customizable):**
- Group size (inches/mm)
- MOA/MIL equivalent
- Mean radius
- Shot count
- Distance
- Date/time stamp
- Rifle/ammo info

**Configuration Approach:** Default + Override
- Global defaults configured in Settings > Export Preferences
- Per-export override available when exporting (tap to customize before saving/sharing)

**Why Medium-Hard:** Requires designing the widget UI, implementing drag-to-position, rendering overlay onto image, saving composite image, building settings UI for defaults, and share sheet integration.

---

## 6. Pin Drop for New Locations
**Difficulty:** Medium-Hard | **Type:** iOS Feature | **Effort:** ~8-12 hours

Instead of "Shared Locations" being an option in the sessions page, add an option for users to drop a pin on locations they've shot at previously but aren't currently at.

**Approach:** Integrated (matching webapp pattern)

The webapp's `LocationCombobox` provides a unified location picker with multiple sources. iOS should mirror this:

**Session Creation - Location Picker Options:**
1. **My Locations** - user's saved locations
2. **Current Location** - GPS button for immediate location
3. **Search/Drop Pin** - opens MapKit view for:
   - Geocoding search (type address/place name)
   - Tap-to-place pin anywhere on map
   - Drag pin to fine-tune position
   - After confirming, prompt: "Save this location for future use?"

**Dedicated Location Management:**
- Keep existing Settings > Data > Saved Locations
- Add "+" button to create location outside session context
- Same map picker UI as session flow

**Key UX Details (from webapp):**
- Auto-fetch elevation when pin is placed (use elevation API)
- Draggable pin for fine-tuning
- Show lat/lng coordinates in real-time for verification
- Geocoding search with debounce (300ms, min 3 chars)
- Location preview on map before saving

**Technical Notes:**
- Use MapKit for iOS map integration
- Elevation API: consider Open-Elevation or similar
- Store coordinates with high precision (match webapp: 8 decimal places)

**Reference Files (webapp implementation):**
- `TrueDope/frontend/src/components/location/LocationCombobox.tsx` - unified picker
- `TrueDope/frontend/src/components/map/LocationPicker.tsx` - interactive map
- `TrueDope/frontend/src/pages/locations/LocationForm.tsx` - location creation

**Why Medium-Hard:** New MapKit view, geocoding integration, elevation API, draggable annotations, and integration into session creation flow. Significant new UI but well-defined scope.

---

## 7. Computer Vision Auto-Measure Group Size
**Difficulty:** Hard | **Type:** iOS Feature | **Effort:** ~20-40+ hours

Use computer vision to auto-measure ES (extreme spread) of group sizes.

**Scale Reference Approach:** QR Target System
- Design custom targets with encoded scale markers for accurate measurement
- Distribution: Both printable PDFs (free) and physical targets (premium/sold)

**Considerations:**
- Auto mean radius unlikely (can't auto-place shots)
- Could auto-detect total group size
- Wouldn't be center-to-center (current method)
- If user supplies bullet diameter, radius could be subtracted (×2) from total size

**Proposed Flow:**
1. User shoots group
2. User creates session in TrueDope
3. User initiates group measurement and takes photo of target
4. App detects QR markers and establishes scale
5. App measures total size of group and provides that value
6. App lets user place individual shots and POA to calculate mean radius (optional)
7. User specifies range and number of shots (probably earlier in process)

**Target Design Considerations:**
- Multiple target sizes (pistol, rifle, precision)
- QR-like markers in corners for scale + orientation detection
- Aiming points that work for various disciplines
- Could partner with existing target manufacturers

**Why Hard:** Requires CV/ML for hole detection, QR marker design & detection, scale calibration algorithms, target design work, and significant testing across lighting/paper/distance conditions. R&D-heavy.

---

## 8. Data Value for Manufacturers
**Difficulty:** Hard (non-technical) | **Type:** Strategic | **Effort:** Ongoing

Position the app to provide valuable anonymized aggregate data for:
- Ammo manufacturers
- Barrel/rifle manufacturers

**Data Strategy:** Anonymized Aggregates
- No individual user data shared
- Statistical trends across user base (e.g., "average velocity for Federal GMM 77gr across 1,000+ users")
- Requires sufficient user base to be statistically meaningful

**Potential Data Points:**
- Velocity statistics by ammo type (mean, SD, ES)
- Velocity vs barrel length correlations
- Group size distributions by ammo/rifle combo
- Popular rifle/ammo pairings
- Regional usage patterns (anonymized)

**Privacy Considerations:**
- Clear privacy policy about aggregate data use
- Possibly opt-out option for users who don't want to contribute
- No PII ever included in aggregates

**Business Model Options:**
- Sell reports/dashboards to manufacturers
- Partner with manufacturers for sponsored ammo database entries
- Offer "verified by TrueDope" badge for manufacturer claims

**Why Hard:** Not technically hard, but requires: sufficient user base, business development with manufacturers, legal/privacy review, data pipeline infrastructure, and dashboard/reporting tools. Long-term strategic initiative.

---

## Priority Summary

| # | Item | Difficulty | Type |
|---|------|------------|------|
| 1 | ✅ Summary Cards - Make Functional | Easy | Feature |
| 2 | Velocity Analytics - Multi-Rifle Filter | Easy-Medium | Bug Fix |
| 3 | Duplicate Thumbnails Bug | Medium | Bug Fix |
| 4 | Pinch to Zoom + Caliber Markers | Medium | Feature |
| 5 | Overlay Widget & Export | Medium-Hard | Feature |
| 6 | Pin Drop Locations | Medium-Hard | Feature |
| 7 | Computer Vision Auto-Measure | Hard | Feature |
| 8 | Manufacturer Data | Hard (non-tech) | Strategic |
